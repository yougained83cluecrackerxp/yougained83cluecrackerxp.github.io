<!DOCTYPE html>
<html>
<head>
<link rel="icon" type="image/png" href="https://runescape.wiki/images/thumb/d/de/Gud_raider_chainbody_detail.png/155px-Gud_raider_chainbody_detail.png?982b8">
</head>
<body>
<div id="app"></div>

<style>
.wrapper {
  position: fixed
  left: 0
  top: 0
  width: 100%
  height: 100%
  }
.overlay {
  background-color: #eaeaea
  position: absolute
  left: 0
  top: 0
  width: 100%
  height: 100%
  z-index: 0
  }
.map {
  position: absolute
  z-index: 10
  left: 0
  top: 0
  }
  .map img {
    display: block
    width: 100%
    }
    
h1 {
  position: absolute
  display: block
  left: 0
  bottom: 0
  z-index: 100
  font-family: Roboto, Helvetica, sans-serif
  font-weight: 300
  color: #121212;
  }

</style>

<script>
const { render } = ReactDOM;
const { Component } = React;

class Scroller extends Component {
  scale = 1;
  startScale = 1;
  
  componentDidMount() {
    this.dragInit();
    this.wheelInit();
    this.touchInit();
  }
  
  getMapRef = b => this.map = b;
  getWrapperRef = b => this.wrapper = b;

  dragInit = () => {
    Draggable.create(this.map, {
      type:"x,y", 
      edgeResistance:0.65, 
      bounds: this.wrapper, 
      throwProps:true
    });
  };

  zoom = y => {
    const dur = .15;
    const ease = Cubic.easeOut;
    const step = 0.1;
    const max = 2.5;
    const min = 1;
    const scale = this.scale = ((prev) => {
      if (y < 0) {
        if (prev <= min) {
          return min;
        }
        
        return prev - step;
      } else {
        if (prev >= max) {
          return max;
        }
        
        return prev + step;
      } 
    })(this.scale)
    
    TweenMax.to(this.map, dur, {
      scale,
      ease
    })
    
    console.log(scale);
  };

  wheelInit = () => {
    this.wrapper.addEventListener('wheel', e => {
      this.zoom(e.deltaY)
    })
  };
  
  touchInit = () => {
    this.hammertime = Hammer(this.map)
      .on("transformstart", e => {
          this.startScale = this.map.scaleX();
      }).on("transform", e => {
        console.log(this.startScale * e.gesture.scale)
          TweenMax.to(this.map, .3, {
            scale: this.startScale * e.gesture.scale
          })
      })
  };
  
  render() {
    const {
      getMapRef,
      getWrapperRef
    } = this;
    
    return (
      <div className="wrapper" ref={getWrapperRef}>
        <h1>Drag the map & try to scroll.</h1>
        <div className="map" ref={getMapRef}>
          <img className="map__img" 
            src="https://i.kinja-img.com/gawker-media/image/upload/s--DVFlf5iJ--/c_scale,f_auto,fl_progressive,q_80,w_800/17g5gqe73yvkujpg.jpg"/>
        </div>
        <div className="overlay" />
      </div>
    )
  }
}

render(
  <Scroller/>,
  document.querySelector('#app')
);
</script>
</body>
</html>